import { Canvas, Controls, Meta, Story } from '@storybook/blocks'

import * as FormInputStories from './index.stories'

<Meta of={FormInputStories} />

# FormInput com Formulário Base

O componente **FormInput** é uma entrada de formulário que pode ser utilizada em conjunto com bibliotecas de gerenciamento de formulário como o Unform. Ele suporta validação usando a biblioteca Yup e temas personalizados com o ThemeProvider.

## Uso Básico

O exemplo abaixo mostra um formulário simples com um campo de entrada padrão.

<Canvas of={FormInputStories.Default} />
<Controls />

### Um exemplo de uso basico em código:

```tsx
<Form ref={formRef} onSubmit={formulario}>
  <FormInput
    type="tel"
    name="telefone"
    showErrorMessage
    label="Telefone"
    disabled
    value={usuarioSelecionado?.telefone}
  />
  <FormInput autoFocus type="password" name="senha" showErrorMessage label="Senha" required />
  <Botao isLoading={loading} type="submit" texto="Entrar" id="botaoSenha" />
</Form>
```

Dessa forma colocamos tanto o componente de Input quanto o componente de Form para trabalharem juntos.

### Campo de Senha

Utilize a prop `type="password"` para definir um campo de senha. Esse exemplo também demonstra a integração com um ícone de visibilidade.

<Canvas of={FormInputStories.PasswordInput} />

## Validação com Yup

<Canvas of={FormInputStories.WithErrorMessage} />

Os campos do formulário podem ser validados utilizando a biblioteca Yup. No exemplo acima, o campo "telefone" é validado para garantir que não esteja vazio. Caso a validação falhe, a mensagem de erro é exibida.

```tsx
const formRef = useRef<FormHandles | null>(null)

const handleSubmit = async (data: Record<string, unknown>) => {
  try {
    const schema = Yup.object().shape({
      telefone: Yup.string().required('Telefone é obrigatório.')
    })
    await schema.validate(data, { abortEarly: false })
    console.log('Validação bem-sucedida:', data)
  } catch (error) {
    if (error instanceof ValidationError) {
      const erros: PropsErroYup = {}
      error.inner.forEach(erro => {
        if (erro.path) erros[erro.path] = erro.message
      })
      if (formRef.current) formRef.current.setErrors(erros)
    }
  }
}
```

## Integração com Unform

O **FormInput** pode ser utilizado dentro de um componente `Form` do Unform, facilitando o gerenciamento e validação de formulários complexos.

---

Para mais detalhes sobre a integração e as opções de personalização, consulte a [documentação do Unform](https://unform-rocketseat.vercel.app/quick-start/) e [Yup](https://github.com/jquense/yup).
