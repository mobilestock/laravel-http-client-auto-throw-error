version: '3.8'

services:
  adm-api:
    build: ./apps/adm-api
    volumes:
      - ./apps/adm-api:/app
      - ./shared:/var/shared
  pdo-cast-adm-api-integration:
    build: ./apps/adm-api
    volumes:
      - ./shared/pdo-cast:/app

    working_dir: /app
    entrypoint: sh

    command:
      - -c
      - 'composer install && vendor/bin/phpunit tests --testdox --colors'

  load-balancer:
    image: ghcr.io/lunarmodules/busted:v2.2.0
    volumes:
      - './apps/load-balancer:/data'
    command: .
